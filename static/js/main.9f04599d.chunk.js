(this.webpackJsonp2048=this.webpackJsonp2048||[]).push([[0],{28:function(e,t,n){},29:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var r,a=n(1),c=n.n(a),s=n(20),i=n.n(s),o=(n(28),n(2)),u=(n(29),n(6)),l=n(21),d=[4,6,8];!function(e){e.IDLE="IDLE",e.MOVING="MOVING",e.DYING="DYING",e.INCREASE="INCREASE",e.NEW="NEW"}(r||(r={}));var j=function e(t,n){var r=f(b(n),b(n));return t.some((function(e){return r.x===e.x&&r.y===e.y}))?e(t,n):r},h=function(){var e=[2,2,2,2,2,2,2,2,2,4];return e[Math.floor(Math.random()*e.length)]},b=function(e){return Math.floor(Math.random()*e)},f=function(e,t){return{x:e,y:t,value:h(),id:Date.now(),state:r.NEW}},m=function(e){var t=f(b(e),b(e)),n=j([t],e);return n.id+=1,[t,n]},v=n(3),x=n.n(v),O=n(5),p=n(10),g=n.n(p),S={url:"https://react-game-be.herokuapp.com/",getScore:function(){var e=this;return Object(O.a)(x.a.mark((function t(){var n,r;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.get(e.url);case 2:return n=t.sent,r=n.data,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})))()},create:function(e){var t=this;return Object(O.a)(x.a.mark((function n(){var r;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.post(t.url,{name:e});case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}),n)})))()},update:function(e){var t=this;return Object(O.a)(x.a.mark((function n(){var r,a,c;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=JSON.parse(localStorage.getItem("2048-user")).userId,a={userId:r,four:e[0].highScore,six:e[1].highScore,eight:e[2].highScore},n.next=4,g.a.put(t.url,a);case 4:return c=n.sent,n.abrupt("return",c.data);case 6:case"end":return n.stop()}}),n)})))()}},N=n(8),y=n(22),k=n(23),w=function(){function e(t){var n;Object(y.a)(this,e),this.state=t,this.prevState=void 0,this.prevState=(n=this.state.size,JSON.parse(localStorage.getItem("2048")).find((function(e){return e.size===n})))}return Object(k.a)(e,[{key:"isMoving",value:function(){var e=function(e){return e.map((function(e){return{x:e.x,y:e.y}}))};return JSON.stringify(e(this.state.cells))!==JSON.stringify(e(this.prevState.cells))}},{key:"finish",value:function(){var e=this,t=this.state.cells,n=this.createMatrixFromCells(t);return!function(){if(t.length===Math.pow(e.state.size,2)){for(var r=0;r<n.length;r++)for(var a=0;a<n.length;a++){for(var c,s=a-1,i=a+1,o=r+1,u=r-1,l=null===(c=n[r][a])||void 0===c?void 0:c.value,d=[],j=0,h=[u,o];j<h.length;j++)for(var b=h[j],f=0,m=[s,i];f<m.length;f++){var v,x,O=m[f];if(O>=0&&O<n.length&&b>=0&&b<n.length)d.push(null===(v=n[r][O])||void 0===v?void 0:v.value),d.push(null===(x=n[b][a])||void 0===x?void 0:x.value)}for(var p=0,g=d;p<g.length;p++){if(l===g[p])return!0}}return!1}return!0}()}},{key:"populateField",value:function(){var e=Object(N.a)(this.state.cells);if(!this.isMoving())return e;this.state.prevState=Object(u.a)(Object(u.a)({},this.prevState),{},{prevState:null});var t=[].concat(Object(N.a)(e),[j(e,this.state.size)]);return this.state.cells=t,t}},{key:"removeAndIncreaseCells",value:function(){var e=this,t=Object(N.a)(this.state.cells).filter((function(e){return e.state!==r.DYING})).map((function(t){return t.state===r.INCREASE&&(t.value*=2,e.state.score+=t.value,e.state.highScore<e.state.score&&(e.state.highScore=e.state.score)),t.state=r.IDLE,t}));return this.state.cells=t,t}},{key:"moveCells",value:function(e){var t=Object(N.a)(this.state.cells),n=this.createMatrixFromCells(t);this.rotateMatrixFromDirection(n,e);for(var r=0;r<this.state.size;r++)for(var a=0;a<this.state.size;a++)n[r][a]&&this.moveCell(n,a,r);this.rotateMatrixToDirection(n,e);for(var c=0;c<this.state.size;c++)for(var s=0;s<this.state.size;s++)n[c][s]&&(n[c][s].y=c,n[c][s].x=s);return t.filter((function(e){return e.by})).forEach((function(e){e.x=e.by.x,e.y=e.by.y,delete e.by})),t}},{key:"moveCell",value:function(e,t,n){for(var a=n-1,c=n;a>=0;){if(null===e[a][t])e[a][t]=e[c][t],e[c][t].state=r.MOVING,e[c][t]=null,c=a;else{if(e[a][t].value!==e[c][t].value||e[a][t].state!==r.IDLE&&e[a][t].state!==r.MOVING&&e[a][t].state!==r.NEW)break;e[a][t].state=r.DYING,e[a][t].by=e[c][t],e[c][t].state=r.INCREASE,e[a][t]=e[c][t],e[c][t]=null,c=a}a-=1}}},{key:"_rotateMatrix",value:function(e){e=e.reverse();for(var t=0;t<e.length;t++)for(var n=0;n<t;n++){var r=e[t][n];e[t][n]=e[n][t],e[n][t]=r}}},{key:"rotateMatrixFromDirection",value:function(e,t){switch(t){case"ArrowLeft":this._rotateMatrix(e);break;case"ArrowDown":this._rotateMatrix(e),this._rotateMatrix(e);break;case"ArrowRight":this._rotateMatrix(e),this._rotateMatrix(e),this._rotateMatrix(e)}}},{key:"rotateMatrixToDirection",value:function(e,t){switch(t){case"ArrowRight":this._rotateMatrix(e);break;case"ArrowDown":this._rotateMatrix(e),this._rotateMatrix(e);break;case"ArrowLeft":this._rotateMatrix(e),this._rotateMatrix(e),this._rotateMatrix(e)}}},{key:"createMatrixFromCells",value:function(e){var t=this,n=Array.from(new Array(this.state.size),(function(){return Array.from(new Array(t.state.size),(function(){return null}))}));return e.forEach((function(e){n[e.y][e.x]=e})),n}}]),e}(),_=n(0),E=function(e){var t=e.x,n=e.y,c=e.value,s=e.size,i=e.border,u=e.state,l=Object(a.useState)(c),d=Object(o.a)(l,2),j=d[0],h=d[1],b=Object(a.useState)(!1),f=Object(o.a)(b,2),m=f[0],v=f[1],x=Object(a.createRef)();Object(a.useEffect)((function(){c!==j&&v(!0)}),[j,c]),Object(a.useEffect)((function(){var e=function(e){c!==j&&h(c)},t=x.current;return null===t||void 0===t||t.addEventListener("transitionend",e),function(){return null===t||void 0===t?void 0:t.removeEventListener("transitionend",e)}}),[x,j,u,c]);var O="".concat(function(e){switch(e){case 2:return"two";case 4:return"four";case 8:return"eight";case 16:return"sixteen";case 32:return"thirty";case 64:return"sixty";case 128:return"hundred";case 256:return"two-handred";case 512:return"five-hundred";case 1024:return"thousand";case 2048:return"two-thousands";default:return"black"}}(c)," game__cell play-cell ").concat(u===r.MOVING||u===r.INCREASE?"moving":""," ").concat(m?"highlight":""," ").concat(u===r.NEW?"new":""," ");return Object(_.jsx)("div",{ref:x,onAnimationEnd:function(){v(!1)},className:O,id:c.toString(),style:{height:"".concat(s,"px"),width:"".concat(s,"px"),lineHeight:"".concat(s,"px"),left:"".concat(t*(s+10)+i,"px"),top:"".concat(n*(s+10)+i,"px")},children:c})},I=function(e){var t=e.type,n=e.setModal,r=e.replayHandler,a=e.exitHandler,c=e.setCanMove;return"2048"===t&&c(!1),Object(_.jsx)("div",{className:"modal",children:"2048"===t?Object(_.jsxs)("div",{className:"modal__btns",children:[Object(_.jsx)("button",{className:"modal__btn",onClick:function(){c(!0),n("never")},children:"Continue"}),Object(_.jsx)("button",{className:"modal__btn",onClick:function(){n(void 0),r()},children:"Replay"})]}):Object(_.jsxs)("div",{className:"modal__btns",children:[Object(_.jsx)("button",{className:"modal__btn",onClick:a,children:"EXIT"}),Object(_.jsx)("button",{className:"modal__btn",onClick:function(){n(void 0),r()},children:"REPLAY"})]})})},M=function(e){var t=e.gameState,n=e.setGameState,r=e.exitHandler,c=e.replayHandler,s=e.playSwipe,i=Object(a.useState)(t.cells),l=Object(o.a)(i,2),d=l[0],j=l[1],h=Object(a.useState)(!0),b=Object(o.a)(h,2),f=b[0],m=b[1],v=t.size,p=Object(a.useState)(),g=Object(o.a)(p,2),S=g[0],N=g[1],y=function(){var e=Object(O.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){d.some((function(e){return 2048===e.value}))&&"never"!==S&&N("2048")}),[d,S]),Object(a.useEffect)((function(){j(t.cells)}),[t]),Object(a.useEffect)((function(){var e=function(){var e=Object(O.a)(x.a.mark((function e(r){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("ArrowLeft"!==r.key&&"ArrowDown"!==r.key&&"ArrowRight"!==r.key&&"ArrowUp"!==r.key){e.next=13;break}if(!f){e.next=13;break}return a=new w(t),m(!1),j(a.moveCells(r.key)),a.isMoving()&&s(),e.next=8,y(100);case 8:j(a.removeAndIncreaseCells()),j(a.populateField()),n((function(e){return Object(u.a)({},a.state)})),a.finish()&&N("gameover"),m(!0);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[f,t,s,n]);var k=100;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("div",{className:"game",style:{width:"".concat(k*v+5*(v+1)*2,"px"),height:"".concat(k*v+5*(v+1)*2,"px"),transform:"scale(".concat(4/v,") translate(").concat(100*(4-v)/8,"%, ").concat(100*(4-v)/8,"%)")},children:[Object(_.jsx)("div",{className:"game__background",children:Array.from(new Array(Math.pow(v,2)),(function(e,t){return t})).map((function(e,t){return Object(_.jsx)("div",{style:{height:"".concat(k,"px"),width:"".concat(k,"px")},className:"game__cell"},t)}))}),Object(_.jsx)("div",{className:"game__background playground",children:d.map((function(e){return Object(_.jsx)(E,{x:e.x,y:e.y,value:e.value,size:k,border:5,state:e.state},e.id)}))})]}),S&&"never"!==S?Object(_.jsx)(I,{setModal:N,type:S,replayHandler:c,exitHandler:r,setCanMove:m}):null]})},C=n.p+"static/media/swipe.f8765271.mp3",A=function(e){var t=Object(a.useState)(e.gameState),n=Object(o.a)(t,2),r=n[0],c=n[1],s=r.score,i=r.highScore,d=Object(a.useState)(.25),j=Object(o.a)(d,2),h=j[0],b=j[1];Object(a.useEffect)((function(){!function(e){var t=JSON.parse(localStorage.getItem("2048")).map((function(t){return t.size===e.size?e:t}));localStorage.setItem("2048",JSON.stringify(t)),S.update(t)}(r)}),[r]);var f=Object(l.a)(C,{volume:h}),v=Object(o.a)(f,1)[0],x=function(){c((function(e){return Object(u.a)(Object(u.a)({},e),{},{score:0,cells:m(e.size),prevState:e})}))};return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("header",{children:[Object(_.jsxs)("div",{className:"score-container",children:[Object(_.jsx)("h1",{className:"title",children:"2048"}),Object(_.jsxs)("div",{className:"score-block",children:[Object(_.jsxs)("div",{className:"score header-item",children:[Object(_.jsx)("h5",{children:"SCORE"}),Object(_.jsx)("h3",{children:s})]}),Object(_.jsxs)("div",{className:"score header-item",children:[Object(_.jsx)("h5",{children:"HIGH SCORE"}),Object(_.jsx)("h3",{children:i})]})]})]}),Object(_.jsxs)("nav",{className:"additions",children:[Object(_.jsxs)("div",{className:"additions__left",children:[Object(_.jsx)("button",{onClick:e.exitHandler,className:"back header-item",children:Object(_.jsx)("i",{className:"material-icons",children:"exit_to_app"})}),Object(_.jsx)("button",{onClick:function(){b(.25===h?.5:.5===h?0:.25)},className:"back header-item",children:Object(_.jsx)("i",{className:"material-icons",children:0===h?"volume_mute":.25===h?"volume_down":"volume_up"})})]}),Object(_.jsxs)("div",{className:"additions__right",children:[Object(_.jsx)("button",{onClick:function(){c((function(e){return e.prevState?Object(u.a)({},e.prevState):e}))},className:"replay header-item",children:Object(_.jsx)("i",{className:"material-icons",children:"undo"})}),Object(_.jsx)("button",{onClick:x,className:"replay header-item",children:Object(_.jsx)("i",{className:"material-icons",children:"replay"})})]})]})]}),Object(_.jsx)(M,{gameState:r,setGameState:c,replayHandler:x,exitHandler:e.exitHandler,playSwipe:v})]})},z=function(){return localStorage.getItem("2048-user")?JSON.parse(localStorage.getItem("2048-user")):null},H=function(e){var t=e.setShowScore,n=Object(a.useState)([]),r=Object(o.a)(n,2),c=r[0],s=r[1],i=function(){var e=Object(O.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getScore();case 2:return t=e.sent,s(t),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){i()}),[]);var u=c.map((function(e){return{name:e.name,value:e.four}})).sort((function(e,t){return t.value-e.value})),l=c.map((function(e){return{name:e.name,value:e.six}})).sort((function(e,t){return t.value-e.value})),d=c.map((function(e){return{name:e.name,value:e.eight}})).sort((function(e,t){return t.value-e.value})),j=z(),h=function(e){return"score-item ".concat(j&&e===j.name?"current":"")};return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("div",{className:"top-score",children:[Object(_.jsx)("button",{onClick:function(){return t(!1)},className:"back header-item",children:Object(_.jsx)("i",{className:"material-icons",children:"exit_to_app"})}),Object(_.jsxs)("div",{className:"score-grid",children:[Object(_.jsxs)("div",{className:"score-column",children:[Object(_.jsx)("div",{className:"score-item score-head",children:"4x4"}),u.map((function(e,t){return e.value?Object(_.jsxs)("div",{className:h(e.name),children:[Object(_.jsx)("span",{children:e.value}),Object(_.jsx)("span",{children:e.name})]},t):null}))]}),Object(_.jsxs)("div",{className:"score-column center",children:[Object(_.jsx)("div",{className:"score-item score-head",children:"6x6"}),l.map((function(e,t){return e.value?Object(_.jsxs)("div",{className:h(e.name),children:[Object(_.jsx)("span",{children:e.value}),Object(_.jsx)("span",{children:e.name})]},t):null}))]}),Object(_.jsxs)("div",{className:"score-column",children:[Object(_.jsx)("div",{className:"score-item score-head",children:"8x8"}),d.map((function(e,t){return e.value?Object(_.jsxs)("div",{className:h(e.name),children:[Object(_.jsx)("span",{children:e.value}),Object(_.jsx)("span",{children:e.name})]},t):null}))]})]})]}),Object(_.jsx)("div",{className:"modal"})]})},D=function(e){var t=e.prevSizeHandler,n=e.nextSizeHandler,r=e.startHandler,c=e.size,s=Object(a.useState)(!1),i=Object(o.a)(s,2),u=i[0],l=i[1];return Object(_.jsxs)(_.Fragment,{children:[u?Object(_.jsx)(H,{setShowScore:l}):null,Object(_.jsxs)("div",{className:"menu",children:[Object(_.jsx)("div",{className:"menu-grid",children:Object(_.jsx)("div",{className:4===c?"four-pic":6===c?"six-pic":"eight-pic"})}),Object(_.jsxs)("nav",{className:"size-nav",children:[Object(_.jsx)("button",{onClick:t,children:"<"}),Object(_.jsx)("span",{children:"".concat(c,"x").concat(c)}),Object(_.jsx)("button",{onClick:n,children:">"})]}),Object(_.jsx)("button",{className:"menu-btn",onClick:r,children:"Start Game"}),Object(_.jsx)("button",{className:"menu-btn score-btn",onClick:function(){l(!0)},children:"High Score"})]})]})},F=function(e){var t=e.setUser,n=Object(a.useState)(""),r=Object(o.a)(n,2),c=r[0],s=r[1],i=Object(a.useState)(""),u=Object(o.a)(i,2),l=u[0],d=u[1],j=Object(a.useState)(!1),h=Object(o.a)(j,2),b=h[0],f=h[1],m=function(){var e=Object(O.a)(x.a.mark((function e(n){var r,a,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),f(!0),e.prev=2,e.next=5,S.create(c);case 5:if(404!==(r=e.sent).statusCode){e.next=10;break}return d(r.reason),f(!1),e.abrupt("return");case 10:f(!1),a=r.name,s=r.userId,t({name:a,userId:s}),localStorage.setItem("2048-user",JSON.stringify({name:a,userId:s})),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),e.t0 instanceof Error&&console.warn(e.t0.message),f(!1);case 20:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{className:"modal"}),Object(_.jsx)("form",{onSubmit:m,className:"user",children:b?Object(_.jsx)("h2",{children:"Loading..."}):Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("input",{placeholder:"Enter Name",type:"text",onInput:function(e){var t=e.currentTarget.value;s(t),""!==l&&d("")},value:c}),Object(_.jsx)("span",{children:l}),Object(_.jsx)("button",{type:"submit",className:"modal__btn",children:"Confirm"})]})})]})},L=function(){var e=function(){if(localStorage.getItem("2048"))return JSON.parse(localStorage.getItem("2048"));var e=d.map((function(e){return{size:e,undoMode:!0,cells:m(e),score:0,highScore:0,prevState:null}}));return localStorage.setItem("2048",JSON.stringify(e)),e}(),t=Object(a.useState)(z()),n=Object(o.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)(!1),i=Object(o.a)(s,2),u=i[0],l=i[1],j=Object(a.useState)(d[0]),h=Object(o.a)(j,2),b=h[0],f=h[1],v=e[d.indexOf(b)];return Object(_.jsxs)("div",{className:"container",children:[u?Object(_.jsx)(A,{gameState:v,exitHandler:function(){l(!1)}}):Object(_.jsx)(D,{prevSizeHandler:function(){f(0===d.indexOf(b)?d[d.length-1]:d[d.indexOf(b)-1])},nextSizeHandler:function(){f(d.indexOf(b)+1>=d.length?d[0]:d[d.indexOf(b)+1])},startHandler:function(){l(!0)},size:b}),r?null:Object(_.jsx)(F,{setUser:c})]})},G=function(e){e&&e instanceof Function&&n.e(4).then(n.bind(null,53)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};i.a.render(Object(_.jsx)(c.a.StrictMode,{children:Object(_.jsx)(L,{})}),document.getElementById("root")),G()}},[[50,1,2]]]);
//# sourceMappingURL=main.9f04599d.chunk.js.map