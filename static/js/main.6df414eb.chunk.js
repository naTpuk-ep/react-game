(this.webpackJsonp2048=this.webpackJsonp2048||[]).push([[0],{18:function(e,t,n){},19:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var r,a=n(1),c=n.n(a),i=n(10),s=n.n(i),o=(n(18),n(2)),l=(n(19),n(3)),u=n(11),d=[4,6,8];!function(e){e.IDLE="IDLE",e.MOVING="MOVING",e.DYING="DYING",e.INCREASE="INCREASE",e.NEW="NEW"}(r||(r={}));var h=function e(t,n){var r=v(j(n),j(n));return t.some((function(e){return r.x===e.x&&r.y===e.y}))?e(t,n):r},f=function(){var e=[2,2,2,2,2,2,2,2,2,4];return e[Math.floor(Math.random()*e.length)]},j=function(e){return Math.floor(Math.random()*e)},v=function(e,t){return{x:e,y:t,value:f(),id:Date.now(),state:r.NEW}},b=function(e){var t=v(j(e),j(e)),n=h([t],e);return n.id+=1,[t,n]},m=n(5),x=n.n(m),O=n(9),p=n(6),g=n(12),y=n(13),N=function(){function e(t){var n;Object(g.a)(this,e),this.state=t,this.prevState=void 0,this.prevState=(n=this.state.size,JSON.parse(localStorage.getItem("2048")).find((function(e){return e.size===n}))),this.state.prevState=Object(l.a)(Object(l.a)({},this.prevState),{},{prevState:null})}return Object(y.a)(e,[{key:"isMoving",value:function(){var e=function(e){return e.map((function(e){return{x:e.x,y:e.y}}))};return JSON.stringify(e(this.state.cells))!==JSON.stringify(e(this.prevState.cells))}},{key:"finish",value:function(){var e=this,t=this.state.cells,n=this.createMatrixFromCells(t);return!function(){if(t.length===Math.pow(e.state.size,2)){for(var r=0;r<n.length;r++)for(var a=0;a<n.length;a++){for(var c,i=a-1,s=a+1,o=r+1,l=r-1,u=null===(c=n[r][a])||void 0===c?void 0:c.value,d=[],h=0,f=[l,o];h<f.length;h++)for(var j=f[h],v=0,b=[i,s];v<b.length;v++){var m,x,O=b[v];if(O>=0&&O<n.length&&j>=0&&j<n.length)d.push(null===(m=n[r][O])||void 0===m?void 0:m.value),d.push(null===(x=n[j][a])||void 0===x?void 0:x.value)}for(var p=0,g=d;p<g.length;p++){if(u===g[p])return!0}}return!1}return!0}()}},{key:"populateField",value:function(){var e=Object(p.a)(this.state.cells);if(!this.isMoving())return e;var t=[].concat(Object(p.a)(e),[h(e,this.state.size)]);return this.state.cells=t,t}},{key:"removeAndIncreaseCells",value:function(){var e=this,t=Object(p.a)(this.state.cells).filter((function(e){return e.state!==r.DYING})).map((function(t){return t.state===r.INCREASE&&(t.value*=2,e.state.score+=t.value,e.state.highScore<e.state.score&&(e.state.highScore=e.state.score)),t.state=r.IDLE,t}));return this.state.cells=t,t}},{key:"moveCells",value:function(e){var t=Object(p.a)(this.state.cells);if("ArrowLeft"!==e&&"ArrowDown"!==e&&"ArrowRight"!==e&&"ArrowUp"!==e)return t;var n=this.createMatrixFromCells(t);this.rotateMatrixFromDirection(n,e);for(var r=0;r<this.state.size;r++)for(var a=0;a<this.state.size;a++)n[r][a]&&this.moveCell(n,a,r);this.rotateMatrixToDirection(n,e);for(var c=0;c<this.state.size;c++)for(var i=0;i<this.state.size;i++)n[c][i]&&(n[c][i].y=c,n[c][i].x=i);return t.filter((function(e){return e.by})).forEach((function(e){e.x=e.by.x,e.y=e.by.y,delete e.by})),t}},{key:"moveCell",value:function(e,t,n){for(var a=n-1,c=n;a>=0;){if(null===e[a][t])e[a][t]=e[c][t],e[c][t].state=r.MOVING,e[c][t]=null,c=a;else{if(e[a][t].value!==e[c][t].value||e[a][t].state!==r.IDLE&&e[a][t].state!==r.MOVING&&e[a][t].state!==r.NEW)break;e[a][t].state=r.DYING,e[a][t].by=e[c][t],e[c][t].state=r.INCREASE,e[a][t]=e[c][t],e[c][t]=null,c=a}a-=1}}},{key:"_rotateMatrix",value:function(e){e=e.reverse();for(var t=0;t<e.length;t++)for(var n=0;n<t;n++){var r=e[t][n];e[t][n]=e[n][t],e[n][t]=r}}},{key:"rotateMatrixFromDirection",value:function(e,t){switch(t){case"ArrowLeft":this._rotateMatrix(e);break;case"ArrowDown":this._rotateMatrix(e),this._rotateMatrix(e);break;case"ArrowRight":this._rotateMatrix(e),this._rotateMatrix(e),this._rotateMatrix(e)}}},{key:"rotateMatrixToDirection",value:function(e,t){switch(t){case"ArrowRight":this._rotateMatrix(e);break;case"ArrowDown":this._rotateMatrix(e),this._rotateMatrix(e);break;case"ArrowLeft":this._rotateMatrix(e),this._rotateMatrix(e),this._rotateMatrix(e)}}},{key:"createMatrixFromCells",value:function(e){var t=this,n=Array.from(new Array(this.state.size),(function(){return Array.from(new Array(t.state.size),(function(){return null}))}));return e.forEach((function(e){n[e.y][e.x]=e})),n}}]),e}(),S=n(0),_=function(e){var t=e.x,n=e.y,c=e.value,i=e.size,s=e.border,l=e.state,u=Object(a.useState)(c),d=Object(o.a)(u,2),h=d[0],f=d[1],j=Object(a.useState)(!1),v=Object(o.a)(j,2),b=v[0],m=v[1],x=Object(a.createRef)();Object(a.useEffect)((function(){c!==h&&m(!0)}),[h,c]),Object(a.useEffect)((function(){var e=function(e){c!==h&&f(c)},t=x.current;return null===t||void 0===t||t.addEventListener("transitionend",e),function(){return null===t||void 0===t?void 0:t.removeEventListener("transitionend",e)}}),[x,h,l,c]);var O="".concat(function(e){switch(e){case 2:return"two";case 4:return"four";case 8:return"eight";case 16:return"sixteen";case 32:return"thirty";case 64:return"sixty";case 128:return"hundred";case 256:return"two-handred";case 512:return"five-hundred";case 1024:return"thousand";case 2048:return"two-thousands";default:return"black"}}(c)," game__cell play-cell ").concat(l===r.MOVING||l===r.INCREASE?"moving":""," ").concat(b?"highlight":""," ").concat(l===r.NEW?"new":""," ");return Object(S.jsx)("div",{ref:x,onAnimationEnd:function(){m(!1)},className:O,id:c.toString(),style:{height:"".concat(i,"px"),width:"".concat(i,"px"),lineHeight:"".concat(i,"px"),left:"".concat(t*(i+10)+s,"px"),top:"".concat(n*(i+10)+s,"px")},children:c})},w=function(e){var t=e.type,n=e.setModal,r=e.replayHandler,a=e.exitHandler,c=e.setCanMove;return"2048"===t&&c(!1),Object(S.jsx)("div",{className:"modal",children:"2048"===t?Object(S.jsxs)("div",{className:"modal__btns",children:[Object(S.jsx)("button",{className:"modal__btns__btn",onClick:function(){c(!0),n("never")},children:"Continue"}),Object(S.jsx)("button",{className:"modal__btns__btn",onClick:function(){n(void 0),r()},children:"Replay"})]}):Object(S.jsxs)("div",{className:"modal__btns",children:[Object(S.jsx)("button",{className:"modal__btns__btn",onClick:a,children:"EXIT"}),Object(S.jsx)("button",{className:"modal__btns__btn",onClick:function(){n(void 0),r()},children:"REPLAY"})]})})},k=function(e){var t=e.gameState,n=e.setGameState,r=e.exitHandler,c=e.replayHandler,i=e.playSwipe,s=Object(a.useState)(t.cells),u=Object(o.a)(s,2),d=u[0],h=u[1],f=Object(a.useState)(!0),j=Object(o.a)(f,2),v=j[0],b=j[1],m=t.size,p=Object(a.useState)(),g=Object(o.a)(p,2),y=g[0],k=g[1],M=function(){var e=Object(O.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){d.some((function(e){return 2048===e.value}))&&"never"!==y&&k("2048")}),[d,y]),Object(a.useEffect)((function(){h(t.cells)}),[t]),Object(a.useEffect)((function(){var e=function(){var e=Object(O.a)(x.a.mark((function e(r){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v){e.next=12;break}return a=new N(t),b(!1),h(a.moveCells(r.key)),a.isMoving()&&i(),e.next=7,M(100);case 7:h(a.removeAndIncreaseCells()),h(a.populateField()),n((function(e){return Object(l.a)({},a.state)})),a.finish()&&k("gameover"),b(!0);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[v,t,i,n]);var E=100;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("div",{className:"game",style:{width:"".concat(E*m+5*(m+1)*2,"px"),height:"".concat(E*m+5*(m+1)*2,"px"),transform:"scale(".concat(4/m,") translate(").concat(100*(4-m)/8,"%, ").concat(100*(4-m)/8,"%)")},children:[Object(S.jsx)("div",{className:"game__background",children:Array.from(new Array(Math.pow(m,2)),(function(e,t){return t})).map((function(e,t){return Object(S.jsx)("div",{style:{height:"".concat(E,"px"),width:"".concat(E,"px")},className:"game__cell"},t)}))}),Object(S.jsx)("div",{className:"game__background playground",children:d.map((function(e){return Object(S.jsx)(_,{x:e.x,y:e.y,value:e.value,size:E,border:5,state:e.state},e.id)}))})]}),y&&"never"!==y?Object(S.jsx)(w,{setModal:k,type:y,replayHandler:c,exitHandler:r,setCanMove:b}):null]})},M=n.p+"static/media/swipe.f8765271.mp3",E=function(e){var t=Object(a.useState)(e.gameState),n=Object(o.a)(t,2),r=n[0],c=n[1],i=r.score,s=r.highScore,d=Object(a.useState)(.25),h=Object(o.a)(d,2),f=h[0],j=h[1];!function(e){var t=JSON.parse(localStorage.getItem("2048")).map((function(t){return t.size===e.size?e:t}));localStorage.setItem("2048",JSON.stringify(t))}(r);var v=Object(u.a)(M,{volume:f}),m=Object(o.a)(v,1)[0],x=function(){c((function(e){return Object(l.a)(Object(l.a)({},e),{},{score:0,cells:b(e.size),prevState:e})}))};return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("header",{children:[Object(S.jsxs)("div",{className:"score-container",children:[Object(S.jsx)("h1",{className:"title",children:"2048"}),Object(S.jsxs)("div",{className:"score-block",children:[Object(S.jsxs)("div",{className:"score header-item",children:[Object(S.jsx)("h5",{children:"SCORE"}),Object(S.jsx)("h3",{children:i})]}),Object(S.jsxs)("div",{className:"score header-item",children:[Object(S.jsx)("h5",{children:"HIGH SCORE"}),Object(S.jsx)("h3",{children:s})]})]})]}),Object(S.jsxs)("nav",{className:"additions",children:[Object(S.jsxs)("div",{className:"additions__left",children:[Object(S.jsx)("button",{onClick:e.exitHandler,className:"back header-item",children:Object(S.jsx)("i",{className:"material-icons",children:"exit_to_app"})}),Object(S.jsx)("button",{onClick:function(){j(.25===f?.5:.5===f?0:.25)},className:"back header-item",children:Object(S.jsx)("i",{className:"material-icons",children:0===f?"volume_mute":.25===f?"volume_down":"volume_up"})})]}),Object(S.jsxs)("div",{className:"additions__right",children:[Object(S.jsx)("button",{onClick:function(){c((function(e){return e.prevState?Object(l.a)({},e.prevState):e}))},className:"replay header-item",children:Object(S.jsx)("i",{className:"material-icons",children:"undo"})}),Object(S.jsx)("button",{onClick:x,className:"replay header-item",children:Object(S.jsx)("i",{className:"material-icons",children:"replay"})})]})]})]}),Object(S.jsx)(k,{gameState:r,setGameState:c,replayHandler:x,exitHandler:e.exitHandler,playSwipe:m})]})},C=function(e){var t=e.prevSizeHandler,n=e.nextSizeHandler,r=e.startHandler,a=e.size;return Object(S.jsxs)("div",{className:"menu",children:[Object(S.jsx)("div",{className:"menu-grid",children:Object(S.jsx)("div",{className:4===a?"four-pic":6===a?"six-pic":"eight-pic"})}),Object(S.jsxs)("nav",{className:"size-nav",children:[Object(S.jsx)("button",{onClick:t,children:"<"}),Object(S.jsx)("span",{children:"".concat(a,"x").concat(a)}),Object(S.jsx)("button",{onClick:n,children:">"})]}),Object(S.jsx)("button",{className:"menu-btn",onClick:r,children:"Start Game"})]})},I=function(){var e=function(){if(localStorage.getItem("2048"))return JSON.parse(localStorage.getItem("2048"));var e=d.map((function(e){return{size:e,undoMode:!0,cells:b(e),score:0,highScore:0,prevState:null}}));return localStorage.setItem("2048",JSON.stringify(e)),e}(),t=Object(a.useState)(!1),n=Object(o.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(d[0]),s=Object(o.a)(i,2),l=s[0],u=s[1],h=e[d.indexOf(l)];return Object(S.jsx)("div",{className:"container",children:r?Object(S.jsx)(E,{gameState:h,exitHandler:function(){c(!1)}}):Object(S.jsx)(C,{prevSizeHandler:function(){u(0===d.indexOf(l)?d[d.length-1]:d[d.indexOf(l)-1])},nextSizeHandler:function(){u(d.indexOf(l)+1>=d.length?d[0]:d[d.indexOf(l)+1])},startHandler:function(){c(!0)},size:l})})},A=function(e){e&&e instanceof Function&&n.e(4).then(n.bind(null,25)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};s.a.render(Object(S.jsx)(c.a.StrictMode,{children:Object(S.jsx)(I,{})}),document.getElementById("root")),A()}},[[22,1,2]]]);
//# sourceMappingURL=main.6df414eb.chunk.js.map